{% extends 'base.html' %}

{% load archive_extras %}

{% block extrahead %}
<script type="text/javascript" src="{{ STATIC_URL }}js/search.js"></script>
{% endblock %}

{% block title %}Mail Archive{% endblock %}

{% block content %}

    <!-- use context "form" to re-display search form -->
  
    <div id="msg-headers">         
        <div id="search-header">
          {% include "includes/search_box.html" %}
        </div> <!-- search-header -->        
    </div> <!-- msg-headers -->
        
    <div id="msg-container">
        <div id="sidebar">
            <div id="search-filters">
                <h4>FILTER BY TIME</h4>
                <ul class="filter-options" tabindex="-1">
                  <li class="filter-item"><a class="{% selected request 'qdr' '' %}" href="{% append_to_get qdr='' %}">Anytime</a></li>
                  <li class="filter-item"><a class="{% selected request 'qdr' 'd' %}" href="{% append_to_get qdr='d' %}">Past day</a></li>
                  <li class="filter-item"><a class="{% selected request 'qdr' 'w' %}" href="{% append_to_get qdr='w' %}">Past week</a></li>
                  <li class="filter-item"><a class="{% selected request 'qdr' 'm' %}" href="{% append_to_get qdr='m' %}">Past month</a></li>
                  <li class="filter-item"><a class="{% selected request 'qdr' 'y' %}" href="{% append_to_get qdr='y' %}">Past year</a></li>
                </ul>
                <h4>FILTER BY LIST</h4>
                <ul class="filter-options" tabindex="-1">
                </ul>
                <h4>FILTER BY FROM</h4>
                <ul class="filter-options" tabindex="-1">
                </ul>
                <p>{{ facets }}</p>
            </div> <!-- search-filters -->
        </div> <!-- msg-left-nav -->
        
        <div id="msg-panes">    
            <div id="list-pane">
                <div id="msg-list-header">
                    <table id="msg-list-header-table">
                        <thead>
                            <tr>
                                <th><a id="sort-date-button" class="unsorted sortbutton" href="#">Date</a></th>
                                <th><a id="sort-thread-button" class="unsorted sortbutton" href="#">Subject</a></th>
                                <th><a id="sort-from-button" class="unsorted sortbutton" href="#">From</a></th>
                                <th><a id="sort-list-button" class="unsorted sortbutton" href="#">List</a></th>
                                <th><a id="sort-score-button" class="unsorted sortbutton" href="#">Score</a></th>
                            </tr>
                        </thead>
                    </table>
                </div>
                <div id="msg-list" tabindex="-1">
                    <table id="msg-table" class="no-zebra">
                    {% for result in page.object_list %}
                        <tr>
                            <td>{{ result.object.date|date:"m/d/Y" }}</td>
                            {# <td><a href="{% url archive_detail id=result.object.hashcode %}">{{ result.object.subject }}</a></td> #}
                            <td class="nowrap">{{ result.object.subject|truncatechars:70 }}</td>
                            <td>{{ result.object.friendly_frm|truncatechars:35 }}</td>
                            <td>{{ result.object.email_list }}</td>
                            <td>{{ result.score }}</td>
                            <td class="hidden">{{ result.object.id }}</td>
                        </tr>
                    {% empty %}
                        <p>No results found.</p>
                    {% endfor %}
                    </table>
                </div> <!-- msg-list -->
                
                <div id="msg-list-controls">
                    {# Showing {{ page.object_list|length }} of {{ page.paginator.count }} #}
                    {{ page.paginator.count }} Messages
        
                    {% if page.has_previous or page.has_next %}
                        <span class="right">
                            {{ page|cut:"<"|cut:">" }}&nbsp;
                            {% if page.has_previous %}<a class="msg-link" href="{% append_to_get page=page.previous_page_number %}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
                            |
                            {% if page.has_next %}<a class="msg-link" href="{% append_to_get page=page.next_page_number %}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
                        </span>
                    {% endif %}
                </div> <!-- msg-list-controls -->
            </div> <!-- list-pane -->
            <div id="splitter-pane" class="draggable"></div>
            <div id="view-pane"></div>
        </div> <!-- msg-panes -->
    </div> <!-- msg-container -->
{% endblock %}
